services:
  sirr:
    build: .
    ports:
      - "8080:8080"
    volumes:
      # Persistent data (database + salt).
      - sirr-data:/data
      # Master key file â€” read-only mount. Preferred over SIRR_MASTER_KEY env var.
      # Create the key: openssl rand -hex 32 > ./master.key && chmod 400 ./master.key
      - ./master.key:/run/secrets/master.key:ro
    environment:
      SIRR_MASTER_KEY_FILE: /run/secrets/master.key
      SIRR_DATA_DIR: /data
      SIRR_HOST: "0.0.0.0"
      SIRR_PORT: "8080"
      # Uncomment for >100 secrets:
      # SIRR_LICENSE_KEY: "sirr_lic_..."
    restart: unless-stopped

volumes:
  sirr-data:
